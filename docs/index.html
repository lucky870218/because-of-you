<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>因為有你</title>
    <style>
        /* 背景設定 */
        body { 
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; 
            text-align: center; 
            margin: 0;
            padding: 0;
            /* 填入你的背景圖路徑 */
            background-image: url('images/front.png'); 
            
            /* 讓背景圖覆蓋整個螢幕，不隨捲軸拉伸 */
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            
            /* 確保背景填滿整個手機高度 */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* 增加一個半透明遮罩層，確保文字清晰可讀 */
        .content-overlay {
            background-color: rgba(255, 255, 255, 0.75); /* 白色半透明 */
            padding: 40px 20px;
            border-radius: 20px;
            margin: 20px;
            backdrop-filter: blur(5px); /* 磨砂玻璃效果，若手機支援會很漂亮 */
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-width: 85%;
        }

        h1 { font-size: 2.2rem; margin-bottom: 10px; color: #ff6969; }
        p { font-size: 1.1rem; color: #444; margin-bottom: 30px; line-height: 1.6; }
        
        .btn-container { display: flex; flex-direction: column; align-items: center; }
        
        button { 
            padding: 15px 40px; 
            margin: 10px; 
            font-size: 18px; 
            cursor: pointer;
            border: none; 
            border-radius: 50px; 
            background-color: #ffb6c1; 
            color: white;
            transition: transform 0.2s, background-color 0.3s;
            width: 220px;
            box-shadow: 0 4px 15px rgba(255, 182, 193, 0.4);
        }
        button:hover { background-color: #ff8c94; transform: translateY(-3px); }
    </style>
</head>
<body>

    <div class="content-overlay">
        <h1>因為有你</h1>
        <p>這個世界多了點什麼 ?</p>

        <div class="btn-container">
            <button onclick="goToResult(1)">多一點理解</button>
            <button onclick="goToResult(2)">多一點包容</button>
            <button onclick="goToResult(3)">多一點陪伴</button>
            <button onclick="goToResult(4)">多一點幽默</button>
        </div>
    </div>

    <script>

        // 1. 取得網址參數，判斷是否為重新掃碼
        const urlParams = new URLSearchParams(window.location.search);
        const isNewScan = urlParams.get('from') === 'qrcode';

        // 2. 如果是重新掃碼，清空紀錄
        if (isNewScan) {
            localStorage.removeItem('selected_file');
        }

        // 3. 檢查是否有選擇過
        const savedFile = localStorage.getItem('selected_file');
        if (savedFile) {
            // 如果有紀錄，直接鎖死在當初那個特定的 HTML 檔案
            window.location.replace(savedFile);
        }

        // 4. 修改後的跳轉函數
        function goToResult(id) {
            // 隨機產生 1, 2, 3 其中一個
            const randomImgIndex = Math.floor(Math.random() * 3) + 1;
            
            // 組合成目標檔名，例如 "button1-2.html"
            const targetFile = `button${id}-${randomImgIndex}.html`;

            // 儲存檔名，確保下次進來直接跳轉到這個檔案
            localStorage.setItem('selected_file', targetFile);

            // 執行跳轉
            window.location.replace(targetFile);
        }

        // 預載入圖片邏輯 (保持 1-1.jpg 到 4-3.jpg)
        window.onload = function() {
            setTimeout(function() {
                for (let i = 1; i <= 4; i++) {
                    for (let j = 1; j <= 3; j++) {
                        const img = new Image();
                        img.src = `images/${i}-${j}.jpg`;
                    }
                }
            }, 1000);
        };

    </script>
</body>
</html>