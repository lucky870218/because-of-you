<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>你的特質結果 - 因為有你</title>
    <meta property="og:title" content="因為有你 - 測測你身體中的特質" />
    <meta property="og:description" content="我測出的特質是...快來看看你的！" />
    
    <style>
        body { 
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; 
            text-align: center; 
            padding: 20px; 
            background-color: #fffafb; 
            color: #444;
        }
        h2 { margin-top: 30px; color: #ff8c94; }
        .image-wrapper { min-height: 300px; margin: 20px 0; }
        #result-img { max-width: 90%; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: none; }
        
        /* 轉圈圈 */
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid #ffb6c1; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* 按鈕樣式 */
        .btn-group { margin-top: 20px; display: flex; flex-direction: column; align-items: center; }
        .btn { 
            display: inline-block; padding: 12px 25px; margin: 8px; 
            text-decoration: none; border-radius: 30px; font-size: 16px; 
            width: 200px; transition: 0.3s; color: white; border: none; font-weight: bold;
        }
        .download { background-color: #ffb6c1; }
        .share-line { background-color: #06C755; }
        .back { background-color: transparent; color: #888; border: 1px solid #ccc; }
        
        .btn:hover { opacity: 0.8; transform: scale(1.05); }
    </style>
</head>
<body>

    <h2>這是屬於你的特質</h2>
    
    <div class="image-wrapper">
        <div id="loading-spinner" class="loader"></div>
        <img id="result-img" src="" alt="特質圖片">
    </div>

    <div class="btn-group">
        <a id="download-link" class="btn download" download>下載圖片保存</a>
        
        <a id="line-share" class="btn share-line" target="_blank">分享到 LINE</a>

        <a href="index.html" class="btn back">重新測一次</a>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id') || '1';
        const imgPath = `./images/${id}.png`;
        const currentUrl = window.location.href; // 取得目前網頁連結

        const imgElement = document.getElementById('result-img');
        const spinner = document.getElementById('loading-spinner');
        const downloadLink = document.getElementById('download-link');

        // 設定下載連結
        downloadLink.href = imgPath;

        // 修改原本的 LINE 分享邏輯
        const lineShareBtn = document.getElementById('line-share');
        // 這裡要把網址指向對應的 r1.html, r2.html 或 r3.html
        const shareUrl = `https://lucky870218.github.io/because-of-you/r${id}.html`;

        lineShareBtn.href = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(shareUrl)}`;

        // 設定 LINE 分享連結 (文字 + 網址)
        //const lineText = encodeURIComponent("我測出了我的特質，你也來試試看吧！");
        //document.getElementById('line-share').href = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(currentUrl)}&text=${lineText}`;

        // 圖片載入邏輯
        imgElement.onload = function() {
            spinner.style.display = 'none';
            imgElement.style.display = 'inline-block';
        };
        imgElement.src = imgPath;
    </script>
</body>
</html>